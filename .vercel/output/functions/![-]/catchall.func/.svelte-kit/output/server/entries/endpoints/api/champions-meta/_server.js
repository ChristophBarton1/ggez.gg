const e=new Map,a={top:[2,23,24,266,114,86,36,41,75,420,516,85,157,203,240,27,6,58,59,126,10,82,68,72,13,54,78,92,17,50,122,56,14,98,48,44,83,77],jungle:[28,11,77,5,427,64,106,20,60,121,141,245,30,113,35,154,131,234,19,76,421,203,104,120,62,79,107,80,254,59,163,102,9,72],mid:[1,238,103,84,166,34,166,45,38,105,3,74,134,43,61,69,131,90,127,142,115,268,136,163,517,101,7,157,161,4,50,112,8,143,25,55],adc:[22,110,51,81,119,96,222,429,145,236,21,133,18,202,498,15,523,29,42,67,221,360,126],support:[12,53,201,40,432,555,223,111,117,25,267,89,37,412,235,16,43,526,350,147,63,101,497,143]};async function t({url:t}){try{const s=t.searchParams.get("rank")||"platinum_plus",n=t.searchParams.get("role")||"all",r=t.searchParams.get("region")||"euw",o=t.searchParams.get("queue")||"ranked_solo",l=t.searchParams.get("patch")||"current",c=function(t,s,n,r,o){const l=`${r}_${o}_${n}_${t}_${s}`,c=e.get(l);if(c&&Date.now()-c.timestamp<6e5)return c.data;const i=[];let u;if("all"===s||"default"===s)u=Array.from({length:172},(e,a)=>a+1);else{const e=a[s]||[],t=Array.from({length:172},(e,a)=>a+1).filter(a=>!e.includes(a)).slice(0,Math.floor(.2*e.length));u=[...e,...t]}const h=`${r}_${o}_${n}_${t}_${s}`.split("").reduce((e,a)=>e+a.charCodeAt(0),0);return u.forEach((e,l)=>{const c=Math.abs(43758.5453*Math.sin(h+12.9898*e))%1,u=Math.abs(43758.5453*Math.sin(h+78.233*e))%1,p=Math.abs(43758.5453*Math.sin(h+45.164*e))%1,d=Math.abs(43758.5453*Math.sin(h+31.421*e))%1,m="all"===s||"default"===s||a[s]&&a[s].includes(e);let g=8,_=46;"master"===t||"challenger"===t?(g=6,_=47):"diamond"!==t&&"diamond_plus"!==t||(g=7,_=46.5),"aram"===r?(g=10,_=40):"normal"===r?(g=9,_=45):"ranked_solo"===r&&(_+=1),"14.23"===o&&(_-=.5),"14.22"===o&&(_-=1),"14.21"===o&&(_-=1.5),m||(_-=2.5);const $=(_+c*g).toFixed(2);let f=1;"mid"!==s&&"jungle"!==s||(f=1.2),"support"===s&&(f=.8),m||(f*=.4);const M=(.5+19.5*u*f).toFixed(2);let w=1;"iron"!==t&&"bronze"!==t||(w=1.3),"master"!==t&&"challenger"!==t||(w=.7);const y=(50*p*w).toFixed(2);let b="B";const R=parseFloat($);R>=53?b="S+":R>=52?b="S":R>=51?b="A+":R>=50&&(b="A");let k=1;"kr"===n&&(k=1.5),"euw"!==n&&"na"!==n||(k=1.2),"platinum_plus"!==t&&"diamond_plus"!==t||(k*=1.3);const F=Math.floor(1e4*k+5e4*d);i.push({championId:e,winRate:$,pickRate:M,banRate:y,games:F,tier:b})}),i.sort((e,a)=>parseFloat(a.winRate)-parseFloat(e.winRate)),e.set(l,{data:i,timestamp:Date.now()}),i}(s,n,r,o,l),i=`${o}_${l}_${r}_${s}_${n}`;return new Response(JSON.stringify({success:!0,queue:o,patch:l,region:r,rank:s,role:n,champions:c,count:c.length,source:"generated",cached:e.has(i),note:"Realistic simulated data. Stats vary by queue, patch, region, rank, and role."}),{status:200,headers:{"Content-Type":"application/json","Cache-Control":"public, max-age=600"}})}catch(s){return new Response(JSON.stringify({success:!1,error:s.message}),{status:500,headers:{"Content-Type":"application/json"}})}}export{t as GET};
