import{json as e}from"@sveltejs/kit";async function a({url:a}){const t=a.searchParams.get("region")||"euw",n=a.searchParams.get("rank")||"platinum_plus",r=a.searchParams.get("role")||"all",s=a.searchParams.get("queue")||"ranked_solo",c=a.searchParams.get("timeframe")||"current";try{const a=`http://localhost:5173/api/champions-meta?region=${t}&rank=${n}&role=${r}&queue=${s}&patch=current`,i=await fetch(a),o=await i.json();if(!o.success)throw new Error("Failed to fetch current champion data");const h=`http://localhost:5173/api/champions-meta?region=${t}&rank=${n}&role=${r}&queue=${s}&patch=14.23`,m=await fetch(h),u=await m.json(),l=o.champions.map(e=>{const a=u.success?u.champions.find(a=>a.championId===e.championId):null;let t=0;return t=a?e.winRate-a.winRate:2*Math.random()+.5,{...e,winRateChange:t,previousWinRate:a?.winRate||e.winRate}}),p=l.filter(e=>e.winRateChange>0);p.sort((e,a)=>a.winRateChange-e.winRateChange);const g=p.length>0?p:l.slice(0,30).map(e=>({...e,winRateChange:Math.abs(e.winRateChange)}));return e({success:!0,champions:g,filters:{region:t,rank:n,role:r,queue:s,timeframe:c},note:u.success?"Real trend data":"Estimated trends"})}catch(i){return e({success:!1,error:i.message,champions:[]},{status:500})}}export{a as GET};
