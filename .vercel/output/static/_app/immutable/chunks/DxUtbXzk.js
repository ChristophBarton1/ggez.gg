const t="RGAPI-f36f4b7f-33dc-4e2d-b226-ef1d6e8b8bce",a={EUW:"europe",EUW1:"europe",NA:"americas",NA1:"americas",BR1:"americas",LA1:"americas",LA2:"americas",KR:"asia",JP1:"asia",OC1:"sea",TR1:"europe",RU:"europe"},s={EUW:"euw1",NA:"na1",KR:"kr",BR1:"br1",LA1:"la1",LA2:"la2",OC1:"oc1",JP1:"jp1",TR1:"tr1",RU:"ru"};async function e(e,i,o="EUW"){try{const n=`https://${a[o]||"europe"}.api.riotgames.com/riot/account/v1/accounts/by-riot-id/${encodeURIComponent(e)}/${encodeURIComponent(i)}`,r=await fetch(n,{headers:{"X-Riot-Token":t}});if(!r.ok){if(404===r.status)return{error:"Summoner not found"};throw new Error(`Account API error: ${r.status}`)}const l=await r.json(),{puuid:c,gameName:m,tagLine:u}=l,d=s[o]||"euw1",[h,g]=await Promise.all([fetch(`https://${d}.api.riotgames.com/lol/summoner/v4/summoners/by-puuid/${c}`,{headers:{"X-Riot-Token":t}}),fetch(`https://${d}.api.riotgames.com/lol/league/v4/entries/by-puuid/${c}`,{headers:{"X-Riot-Token":t}})]);if(!h.ok)throw new Error(`Summoner API error: ${h.status}`);const f=await h.json();let p=[];return g.ok?p=await g.json():await g.text(),{puuid:c,id:f.id,summonerId:f.id,accountId:f.accountId,name:m,tag:u,profileIconId:f.profileIconId,summonerLevel:f.summonerLevel,ranked:p,region:o,platform:d}}catch(n){return{error:n.message}}}function i(t){return new Promise(a=>setTimeout(a,t))}async function o(s,e,o=20){try{const n=function(t){return a[t]||a[t.toUpperCase()]||"europe"}(e),r=`https://${n}.api.riotgames.com/lol/match/v5/matches/by-puuid/${s}/ids?start=0&count=${o}`,l=await fetch(r,{headers:{"X-Riot-Token":t}});if(!l.ok)return[];const c=await l.json(),m=await async function(a,s,e=10,o=200){const n=[];for(let r=0;r<a.length;r+=e){const l=a.slice(r,r+e).map(async a=>{const e=`https://${s}.api.riotgames.com/lol/match/v5/matches/${a}`;try{const a=await fetch(e,{headers:{"X-Riot-Token":t}});if(!a.ok){if(429===a.status){await i(3e3);const a=await fetch(e,{headers:{"X-Riot-Token":t}});return a.ok?await a.json():null}return null}return await a.json()}catch(o){return null}}),c=await Promise.all(l);n.push(...c.filter(t=>null!==t)),r+e<a.length&&await i(o)}return n}(c,n);return m}catch(n){return[]}}function n(t,a){const s={};return t.forEach(t=>{const e=t.info.participants.find(t=>t.puuid===a);if(!e)return;const i=e.championName;s[i]||(s[i]={championName:i,championId:e.championId,games:0,wins:0,kills:0,deaths:0,assists:0});const o=s[i];o.games++,e.win&&o.wins++,o.kills+=e.kills,o.deaths+=e.deaths,o.assists+=e.assists}),Object.values(s).map(t=>({...t,winrate:t.wins/t.games*100,avgKills:t.kills/t.games,avgDeaths:t.deaths/t.games,avgAssists:t.assists/t.games,kda:0===t.deaths?t.kills+t.assists:(t.kills+t.assists)/t.deaths})).sort((t,a)=>a.games-t.games)}function r(t,a){const s={},e=[420,440];return t.forEach(t=>{if(!e.includes(t.info.queueId))return;const i=t.info.participants.find(t=>t.puuid===a);if(!i)return;const o=i.championName,n=t.info.gameDuration;s[o]||(s[o]={championName:o,championId:i.championId,role:i.teamPosition||"UNKNOWN",games:0,wins:0,lpChange:0,kills:0,deaths:0,assists:0,totalCS:0,totalDamage:0,totalDamageTaken:0,totalGold:0,totalKills:0,totalGameDuration:0,goldDiffAt15:0,csDiffAt15:0,gamesWithGoldDiff:0,gamesWithCSDiff:0});const r=s[o];r.games++;let l=i.win?20:-18;const c=0===i.deaths?i.kills+i.assists:(i.kills+i.assists)/i.deaths;i.win?(c>5&&(l+=2),i.kills>15&&(l+=1)):c>3&&(l+=2),r.lpChange+=l,i.win&&r.wins++,r.kills+=i.kills,r.deaths+=i.deaths,r.assists+=i.assists,r.totalCS+=(i.totalMinionsKilled||0)+(i.neutralMinionsKilled||0),r.totalDamage+=i.totalDamageDealtToChampions||0,r.totalDamageTaken+=i.totalDamageTaken||0,r.totalGold+=i.goldEarned||0,r.totalGameDuration+=n,i.challenges&&i.challenges.goldPerMinute&&(r.goldDiffAt15+=15*i.challenges.goldPerMinute-3e3,r.gamesWithGoldDiff++);const m=t.info.participants.filter(t=>t.teamId===i.teamId).reduce((t,a)=>t+a.kills,0);r.totalKills+=m}),Object.values(s).map(t=>{t.totalGameDuration,t.games;const a=t.totalKills>0?(t.kills+t.assists)/t.totalKills*100:0;return{...t,winrate:t.wins/t.games*100,avgKills:t.kills/t.games,avgDeaths:t.deaths/t.games,avgAssists:t.assists/t.games,kda:0===t.deaths?t.kills+t.assists:(t.kills+t.assists)/t.deaths,csPerMin:t.totalCS/(t.totalGameDuration/60),dpm:t.totalDamage/(t.totalGameDuration/60),goldPerMin:t.totalGold/(t.totalGameDuration/60),killParticipation:a,avgGoldDiffAt15:t.gamesWithGoldDiff>0?t.goldDiffAt15/t.gamesWithGoldDiff:0}}).sort((t,a)=>a.lpChange-t.lpChange)}function l(t){const a=t.match(/^(.+?)\s*#\s*(.+)$/);return a?{gameName:a[1].trim(),tagLine:a[2].trim()}:null}async function c(a,e="EUW"){try{const i=`https://${s[e]||"euw1"}.api.riotgames.com/lol/spectator/v5/active-games/by-summoner/${a}`,o=await fetch(i,{headers:{"X-Riot-Token":t}});if(404===o.status)return{inGame:!1};if(!o.ok){const t=await o.text();throw new Error(`Live Game API error: ${o.status} - ${t}`)}return{inGame:!0,gameData:await o.json()}}catch(i){return{inGame:!1,error:i.message}}}async function m(t,a){return{error:"OpenAI API key not configured",items:[],runes:null}}export{c as a,m as b,n as c,o as d,r as e,e as g,l as p};
